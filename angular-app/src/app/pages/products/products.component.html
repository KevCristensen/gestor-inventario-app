<!-- Contenedor principal con animación de entrada -->
<div class="text-white" style="animation: fade-in-up 0.7s ease-out forwards;">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">Gestionar Productos</h1>
    <button (click)="openModal()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-4 rounded-lg transition-all transform hover:scale-105">
      + Crear Producto
    </button>
  </div>
  
  <!-- Búsqueda General -->
  <div class="mb-6 relative">
    <span class="absolute inset-y-0 left-0 flex items-center pl-3">
      <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
    </span>
    <input 
      type="text" 
      [(ngModel)]="searchTerm" 
      (input)="onSearchChange()"
      placeholder="Buscar por nombre, marca o categoría..."
      class="w-full bg-gray-700/80 p-3 pl-10 rounded-lg border border-gray-600 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 focus:outline-none transition-all duration-300"
      aria-label="Buscar productos">
  </div>

  <div class="bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-lg p-6 border border-gray-700/50">
    <table class="w-full text-left">
      <thead class="border-b-2 border-gray-700">
        <tr class="text-sm text-gray-400">
          <th class="p-4">Código de Barras</th>
          <th class="p-4">Nombre</th>
          <th class="p-4">Categoría</th>
          <th class="p-4">Marca</th>
          <th class="p-4 text-right">Precio</th>
          <th class="p-4 text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for (product of products; track product.id) {
          <tr class="border-b border-gray-700/50 hover:bg-gray-700/40 transition-colors duration-200">
            <td class="p-4 font-mono text-gray-400">{{ product.barcode }}</td>
            <td class="p-4 font-semibold">{{ product.name }}</td>
            <td class="p-4">{{ product.category }}</td>
            <td class="p-4 text-gray-400">{{ product.brand }}</td>
            <td class="p-4 text-right font-mono">${{ product.price | number:'1.0-0' }}</td>
            <td class="p-4 text-center">
              <button (click)="openModal(product)" class="text-blue-400 hover:text-blue-300 mr-4 transition-colors transform hover:scale-110">Editar</button>
              <button (click)="deleteProduct(product.id)" class="text-red-400 hover:text-red-300 transition-colors transform hover:scale-110">Eliminar</button>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="6" class="p-8 text-center text-gray-500">No se encontraron productos con los filtros aplicados.</td>
          </tr>
        }
      </tbody>
    </table>
  </div>

  <div class="flex justify-between items-center mt-6 text-sm">
    <span class="text-sm text-gray-400">
      Mostrando {{ products.length }} de {{ totalItems }} productos
    </span>
    <div class="flex items-center space-x-2">
      <button (click)="goToPage(currentPage - 1)" 
              [disabled]="currentPage === 1" 
              class="px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
        Anterior
      </button>
      <span class="text-white font-semibold">Página {{ currentPage }} de {{ totalPages }}</span>
      <button (click)="goToPage(currentPage + 1)" 
              [disabled]="currentPage === totalPages || totalItems === 0"
              class="px-4 py-2 rounded-lg bg-gray-700 hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors">
        Siguiente
      </button>
    </div>
  </div>
</div>

@if (isModalOpen) {
  <app-product-form 
    [product]="currentProduct" 
    (save)="saveProduct($event)" 
    (close)="closeModal()">
  </app-product-form>
}