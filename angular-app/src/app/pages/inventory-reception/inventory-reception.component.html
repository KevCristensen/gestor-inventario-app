<div class="text-white">
    <h1 class="text-3xl font-bold mb-6">Recepción de Mercadería</h1>
  
    <div class="bg-gray-800 rounded-lg shadow p-6 mb-6 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div>
        <label for="provider" class="block mb-2 text-sm font-medium text-gray-300">Proveedor</label>
        <select id="provider" [(ngModel)]="reception.provider_id" name="provider" required class="w-full bg-gray-700 p-2.5 rounded-lg border border-gray-600">
          <option [ngValue]="null" disabled>Seleccione un proveedor</option>
          @for(provider of providerList; track provider.id) {
            <option [value]="provider.id">{{ provider.name }}</option>
          }
        </select>
      </div>
      <div>
        <label for="invoice_number" class="block mb-2 text-sm font-medium text-gray-300">N° Guía o Factura</label>
        <input type="text" id="invoice_number" [(ngModel)]="reception.invoice_number" name="invoice_number" class="w-full bg-gray-700 p-2.5 rounded-lg border border-gray-600">
      </div>
      <div>
        <label for="transport_temp" class="block mb-2 text-sm font-medium text-gray-300">Temp. Transporte (°C)</label>
        <input type="number" id="transport_temp" [(ngModel)]="reception.transport_temp" name="transport_temp" class="w-full bg-gray-700 p-2.5 rounded-lg border border-gray-600">
      </div>
    </div>
  
    <div class="bg-gray-800 rounded-lg shadow p-6 mb-6">
      <label for="barcode-scanner" class="block mb-2 text-lg font-medium text-gray-300">Escanear Código de Barras</label>
      <input 
        type="text" 
        id="barcode-scanner"
        #barcodeInput
        placeholder="Esperando código..."
        (keyup.enter)="onBarcodeScanned(barcodeInput.value); barcodeInput.value = ''"
        class="w-full p-4 text-xl bg-gray-700 rounded-lg border border-gray-600 focus:ring-blue-500 focus:border-blue-500"
      >
    </div>
  
    <div class="bg-gray-800 rounded-lg shadow p-6">
        <h2 class="text-2xl font-bold mb-4">Items a Registrar</h2>
        <table class="w-full text-left table-fixed">
          
          <thead class="border-b border-gray-600">
            <tr>
              <th class="p-2 w-1/4">Producto</th>
              <th class="p-2 w-24">Cantidad</th>
              <th class="p-2 w-40">Lote</th>
              <th class="p-2 w-48">Vencimiento</th>
              <th class="p-2 w-32">Temp. (°C)</th>
              <th class="p-2 w-24">Acciones</th>
            </tr>
          </thead>
      
          <tbody>
            @for(item of reception.items; track item.product_id) {
              <tr class="border-b border-gray-700">
                <td class="p-2">{{ item.name }}</td>
                <td class="p-2"><input type="number" [(ngModel)]="item.quantity" class="w-full bg-gray-700 p-1 rounded"></td>
                <td class="p-2"><input type="text" [(ngModel)]="item.lot_number" class="w-full bg-gray-700 p-1 rounded"></td>
                <td class="p-2"><input type="date" [(ngModel)]="item.expiration_date" class="w-full bg-gray-700 p-1 rounded text-gray-200" [style.color-scheme]="'dark'"></td>
                <td class="p-2"><input type="number" [(ngModel)]="item.product_temp" class="w-full bg-gray-700 p-1 rounded"></td>
                <td class="p-2">
                  <button (click)="removeItem(item.product_id)" class="text-red-400 hover:text-red-300">Quitar</button>
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="6" class="p-4 text-center text-gray-500">Aún no se han escaneado productos.</td>
              </tr>
            }
          </tbody>
        </table>
        
        <div class="flex justify-end mt-6 space-x-4">
          <button 
            (click)="printReceipt()" 
            [disabled]="reception.items.length === 0"
            class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-3 px-6 rounded-lg disabled:bg-gray-500">
            Imprimir
          </button>
        
          <button 
            (click)="saveReception()" 
            [disabled]="!reception.provider_id || reception.items.length === 0" 
            class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg disabled:bg-gray-500">
            Guardar Recepción
          </button>
        </div>
      </div>
  </div>